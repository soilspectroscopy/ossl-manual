<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>5 Neospectra database | Open Soil Spectral Library</title>
<meta name="author" content="Woodwell Climate Research Center, University of Florida, OpenGeoHub and contributors">
<meta name="description" content="You are reading the work-in-progress of the SoilSpec4GG manual. This chapter is currently draft version, a peer-review publication is pending. A persistent copy of the database is hosted on...">
<meta name="generator" content="bookdown 0.31 with bs4_book()">
<meta property="og:title" content="5 Neospectra database | Open Soil Spectral Library">
<meta property="og:type" content="book">
<meta property="og:url" content="https://soilspectroscopy.github.io/ossl-manual/neospectra-database.html">
<meta property="og:image" content="https://soilspectroscopy.github.io/ossl-manual/cover.png">
<meta property="og:description" content="You are reading the work-in-progress of the SoilSpec4GG manual. This chapter is currently draft version, a peer-review publication is pending. A persistent copy of the database is hosted on...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="5 Neospectra database | Open Soil Spectral Library">
<meta name="twitter:site" content="@soilspec">
<meta name="twitter:description" content="You are reading the work-in-progress of the SoilSpec4GG manual. This chapter is currently draft version, a peer-review publication is pending. A persistent copy of the database is hosted on...">
<meta name="twitter:image" content="https://soilspectroscopy.github.io/ossl-manual/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-06HBX7FM0K"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-06HBX7FM0K');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Open Soil Spectral Library</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About</a></li>
<li><a class="" href="new-to-markdown.html"><span class="header-section-number">1</span> New to markdown</a></li>
<li><a class="" href="soil-spectroscopy-tools-and-users.html"><span class="header-section-number">2</span> Soil spectroscopy tools and users</a></li>
<li><a class="" href="database-description.html"><span class="header-section-number">3</span> Database description</a></li>
<li><a class="" href="database-access.html"><span class="header-section-number">4</span> Database access</a></li>
<li><a class="active" href="neospectra-database.html"><span class="header-section-number">5</span> Neospectra database</a></li>
<li><a class="" href="prediction-models.html"><span class="header-section-number">6</span> Prediction models</a></li>
<li><a class="" href="web-applications-and-api.html"><span class="header-section-number">7</span> Web applications and API</a></li>
<li><a class="" href="references.html"><span class="header-section-number">8</span> References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/soilspectroscopy/ossl-manual">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="neospectra-database" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Neospectra database<a class="anchor" aria-label="anchor" href="#neospectra-database"><i class="fas fa-link"></i></a>
</h1>
<div class="rmdnote">
<p>You are reading the work-in-progress of the SoilSpec4GG manual. This chapter is currently draft version, a peer-review publication is pending.</p>
</div>
<p>A persistent copy of the database is hosted on <a href="https://zenodo.org/record/7600137">Zenodo</a>. Please use the following reference when using the Neospectra database:</p>
<blockquote>
<p>Sanderman, J., Smith, C., Safanelli, J. L., Mitu, S. M., Ge, Y., Murad, O., &amp; Shepherd, K. (2023). Near-infrared (NIR) soil spectral library using the NeoSpectra Handheld NIR Analyzer by Si-Ware. <a href="https://doi.org/10.5281/zenodo.7600137" class="uri">https://doi.org/10.5281/zenodo.7600137</a>.</p>
</blockquote>
<div id="overview" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Overview<a class="anchor" aria-label="anchor" href="#overview"><i class="fas fa-link"></i></a>
</h2>
<p>Recent advances in hardware technology have enabled the development of handheld sensors with similar performance specifications as laboratory-grade near-infrared (NIR) spectrometers.</p>
<p>We have compiled a hand-held NIR spectral library (1350-2550 nm) using the NeoSpectra Handheld NIR Analyzer developed by <a href="https://www.si-ware.com/">Si-Ware</a>. Each scanner is fitted with Fourier-Transform technology based on the semiconductor Micro Electromechanical Systems (MEMS) manufacturing technique, promising accuracy, and consistency between devices.</p>
<p>This library includes 2,106 distinct mineral soil samples scanned across 9 of these portable low-cost NIR spectrometers (indicated by serial no). 2,016 of these soil samples were selected to represent the diversity of mineral soils found in the United States, and 90 samples were selected across Ghana, Kenya, and Nigeria.</p>
<p>519 of the US samples were selected and scanned by <a href="https://www.woodwellclimate.org/">Woodwell Climate Research Center</a>. These samples were queried from the <a href="https://ncsslabdatamart.sc.egov.usda.gov/">USDA NRCS NSSC-KSSL Soil Archives</a> as having a complete set of eight measured properties (TC, OC, TN, CEC, pH, clay, sand, and silt). They were stratified based on the major horizon and taxonomic order, omitting the categories with less than 500 samples. Three percent of each stratum (i.e., a combination of major horizon and taxonomic order) was then randomly selected as the final subset retrieved from KSSLâ€™s physical soil archive as 2-mm sieved samples.</p>
<p>The remaining 1,604 US samples were queried from the USDA NRCS NSSC-KSSL Soil Archives by the <a href="University%20of%20Nebraska%20-%20Lincoln">University of Nebraska - Lincoln</a> to meet the following criteria: Lower depth &lt;= 30 cm, pH range 4.0 to 9.5, Organic carbon &lt;10%, Greater than lower detection limits, Actual physical samples available in the archive, Samples collected and analyzed from 2001 onwards, Samples having complete analyses for high-priority properties (Sand, Silt, Clay, CEC, Exchangeable Ca, Exchangeable Mg, Exchangeable K, Exchangeable Na, CaCO3, OC, TN), &amp; MIR scanned.</p>
<p>All samples were scanned dry 2mm sieved. ~20g of sample was added to a plastic weighing boat where the NeoSpectra scanner would be placed down to make direct contact with the soil surface. The scanner was gently moved across the surface of the sample as 6 replicate scans were taken. These replicates were then averaged so that there is one spectra per sample per scanner in the resulting database.</p>
<div class="inline-figure"><img src="img/nir_neospectra.png" heigth="100%" width="100%"></div>
<div class="inline-figure"><img src="img/pca_neospectra.png" heigth="100%" width="100%"></div>
</div>
<div id="database-access-1" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Database access<a class="anchor" aria-label="anchor" href="#database-access-1"><i class="fas fa-link"></i></a>
</h2>
<div id="google-cloud-bucket" class="section level3" number="5.2.1">
<h3>
<span class="header-section-number">5.2.1</span> Google Cloud Bucket<a class="anchor" aria-label="anchor" href="#google-cloud-bucket"><i class="fas fa-link"></i></a>
</h3>
<p>Use the following URLs to access the whole database levels:</p>
<p><strong>Compressed csv</strong><br><a href="https://storage.googleapis.com/soilspec4gg-public/neospectra_soillab_v1.2.csv.gz" class="uri">https://storage.googleapis.com/soilspec4gg-public/neospectra_soillab_v1.2.csv.gz</a><br><a href="https://storage.googleapis.com/soilspec4gg-public/neospectra_soilsite_v1.2.csv.gz" class="uri">https://storage.googleapis.com/soilspec4gg-public/neospectra_soilsite_v1.2.csv.gz</a><br><a href="https://storage.googleapis.com/soilspec4gg-public/neospectra_nir_v1.2.csv.gz" class="uri">https://storage.googleapis.com/soilspec4gg-public/neospectra_nir_v1.2.csv.gz</a><br><a href="https://storage.googleapis.com/soilspec4gg-public/neospectra_mir_v1.2.csv.gz" class="uri">https://storage.googleapis.com/soilspec4gg-public/neospectra_mir_v1.2.csv.gz</a></p>
<p><strong>qs format (preferred on R)</strong><br><a href="https://storage.googleapis.com/soilspec4gg-public/neospectra_soillab_v1.2.qs" class="uri">https://storage.googleapis.com/soilspec4gg-public/neospectra_soillab_v1.2.qs</a><br><a href="https://storage.googleapis.com/soilspec4gg-public/neospectra_soilsite_v1.2.qs" class="uri">https://storage.googleapis.com/soilspec4gg-public/neospectra_soilsite_v1.2.qs</a><br><a href="https://storage.googleapis.com/soilspec4gg-public/neospectra_nir_v1.2.qs" class="uri">https://storage.googleapis.com/soilspec4gg-public/neospectra_nir_v1.2.qs</a><br><a href="https://storage.googleapis.com/soilspec4gg-public/neospectra_mir_v1.2.qs" class="uri">https://storage.googleapis.com/soilspec4gg-public/neospectra_mir_v1.2.qs</a></p>
<p>Example with R.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/jeroen/curl">"curl"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/traversc/qs">"qs"</a></span><span class="op">)</span> <span class="co"># &gt;=0.25.5</span></span>
<span></span>
<span><span class="co">## Separate files</span></span>
<span><span class="va">soil</span> <span class="op">&lt;-</span>  <span class="st">"https://storage.googleapis.com/soilspec4gg-public/neospectra_soillab_v1.2.qs"</span></span>
<span><span class="va">soil</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/qs/man/qread_url.html">qread_url</a></span><span class="op">(</span><span class="va">soil</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nir</span> <span class="op">&lt;-</span> <span class="st">"https://storage.googleapis.com/soilspec4gg-public/neospectra_nir_v1.2.qs"</span></span>
<span><span class="va">nir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/qs/man/qread_url.html">qread_url</a></span><span class="op">(</span><span class="va">nir</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Join</span></span>
<span><span class="va">neospectra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">right_join</a></span><span class="op">(</span><span class="va">soil</span>, <span class="va">nir</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id.sample_local_c"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="mongodb-1" class="section level3" number="5.2.2">
<h3>
<span class="header-section-number">5.2.2</span> MongoDB<a class="anchor" aria-label="anchor" href="#mongodb-1"><i class="fas fa-link"></i></a>
</h3>
<p>Available collections:</p>
<ul>
<li>
<strong>neospectra_soilsite</strong>: site information, e.g., coordinates, pedons, layers, etc.<br>
</li>
<li>
<strong>neospectra_soillab</strong>: soil laboratory data (wet chemistry), e.g., soil texture, carbon, etc.<br>
</li>
<li>
<strong>neospectra_nir</strong>: Near-infrared (NIR) spectral data in the 1350-2550 nm range with metadata.<br>
</li>
<li>
<strong>neospectra_mir</strong>: Middle-infrared (MIR) spectral data in the 600-4000 cm<sup>-1</sup> range with metadata.</li>
</ul>
<blockquote>
<p><strong><span style="color:orange;">NOTE: Within the MongoDB, all the dots in column names are replaced by underscore.</span></strong></p>
</blockquote>
<p>Accessing in R:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Packages and helping functions</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jeroen/mongolite/">mongolite</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">jsonify</span><span class="op">)</span></span>
<span></span>
<span><span class="va">soilspec4gg.db</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  host <span class="op">=</span> <span class="st">'api.soilspectroscopy.org'</span>,</span>
<span>  name <span class="op">=</span> <span class="st">'soilspec4gg'</span>,</span>
<span>  user <span class="op">=</span> <span class="st">'soilspec4gg'</span>,</span>
<span>  pw <span class="op">=</span> <span class="st">'soilspec4gg'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">url</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">'mongodb://'</span>, <span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">user</span>, <span class="st">':'</span>, </span>
<span>  <span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">pw</span>, <span class="st">'@'</span>, </span>
<span>  <span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">host</span>, <span class="st">'/'</span>, </span>
<span>  <span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">name</span>, <span class="st">'?ssl=true'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">soilspec4gg.init</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">'Creating the access for mongodb collections.'</span><span class="op">)</span></span>
<span>  <span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">collections</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    neospectra_soilsite <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mongolite/man/mongo.html">mongo</a></span><span class="op">(</span>collection <span class="op">=</span> <span class="st">'neospectra_soilsite'</span>, url <span class="op">=</span> <span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">url</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    neospectra_soillab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mongolite/man/mongo.html">mongo</a></span><span class="op">(</span>collection <span class="op">=</span> <span class="st">'neospectra_soillab'</span>, url <span class="op">=</span> <span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">url</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    neospectra_nir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mongolite/man/mongo.html">mongo</a></span><span class="op">(</span>collection <span class="op">=</span> <span class="st">'neospectra_nir'</span>, url <span class="op">=</span> <span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">url</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    neospectra_mir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mongolite/man/mongo.html">mongo</a></span><span class="op">(</span>collection <span class="op">=</span> <span class="st">'neospectra_mir'</span>, url <span class="op">=</span> <span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">url</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Accessing the database</span></span>
<span></span>
<span><span class="co"># Initialization</span></span>
<span><span class="fu">soilspec4gg.init</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Checking available collections</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">collections</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get all records for neospectra_soilsite table</span></span>
<span><span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">collections</span><span class="op">$</span><span class="va">neospectra_soilsite</span><span class="op">$</span><span class="fu">count</span><span class="op">(</span><span class="st">"{}"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read all data from a collection back to the R environment</span></span>
<span><span class="va">neospectra_soilsite</span> <span class="op">&lt;-</span> <span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">collections</span><span class="op">$</span><span class="va">neospectra_soilsite</span><span class="op">$</span><span class="fu">find</span><span class="op">(</span><span class="st">'{}'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Getting unique values for a field</span></span>
<span><span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">collections</span><span class="op">$</span><span class="va">neospectra_soilsite</span><span class="op">$</span><span class="fu">distinct</span><span class="op">(</span>key <span class="op">=</span> <span class="st">"scan_nir_model_name_utf8_txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Getting column names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">collections</span><span class="op">$</span><span class="va">neospectra_soilsite</span><span class="op">$</span><span class="fu">find</span><span class="op">(</span><span class="st">'{}'</span>, limit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">collections</span><span class="op">$</span><span class="va">neospectra_soillab</span><span class="op">$</span><span class="fu">find</span><span class="op">(</span><span class="st">'{}'</span>, limit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">collections</span><span class="op">$</span><span class="va">neospectra_nir</span><span class="op">$</span><span class="fu">find</span><span class="op">(</span><span class="st">'{}'</span>, limit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">collections</span><span class="op">$</span><span class="va">neospectra_mir</span><span class="op">$</span><span class="fu">find</span><span class="op">(</span><span class="st">'{}'</span>, limit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Query a specific device</span></span>
<span><span class="va">nir.neo1</span> <span class="op">&lt;-</span> <span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">collections</span><span class="op">$</span><span class="va">neospectra_nir</span><span class="op">$</span><span class="fu">find</span><span class="op">(</span><span class="st">'{"scan_nir_model_name_utf8_txt" : "NEO1"}'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filtering by ID</span></span>
<span><span class="va">soilspec4gg.db</span><span class="op">$</span><span class="va">collections</span><span class="op">$</span><span class="va">neospectra_soillab</span><span class="op">$</span><span class="fu">find</span><span class="op">(</span><span class="st">'{"id_sample_local_c": "30747"}'</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="database-description-1" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> Database description<a class="anchor" aria-label="anchor" href="#database-description-1"><i class="fas fa-link"></i></a>
</h2>
<p>The Neospectra database follows the same specification of the OSSL for soil and site information. For the near-infrared (NIR) spectra, however, additional information is provided for scanning laboratory, scanner code, and scanning accessory.</p>
<p>NIR is provided in reflectance units per wavelength, with values usually ranging between 0 and 1 as fraction percent. The spectral range imported into the OSSL falls between 1350 and 2550 nm, with an interval of 2 nm.</p>
<p>One can convert reflectance (R) values to absorbance units (A) as <code>A = log10(1/R)</code>, or backtransform with <code>R = 1/(10^A)</code>. Similarly, wavenumber (WN, in cm<sup>-1</sup>) can be converted to wavelength (WL, in nm) with <code>WN = 1/(WL*10000000)</code>, or backtransform with <code>WL = 1/(WL*10000000)</code>. The factor 10M is used to convert cm to nm.</p>
<div id="id.sample_local_c" class="section level3" number="5.3.1">
<h3>
<span class="header-section-number">5.3.1</span> id.sample_local_c<a class="anchor" aria-label="anchor" href="#id.sample_local_c"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: Soil sample identifier.</li>
<li>ðŸ”¢ Type: string.</li>
<li>ðŸ“– Example: 30747.</li>
</ul>
</div>
<div id="id.scan_local_c-2" class="section level3" number="5.3.2">
<h3>
<span class="header-section-number">5.3.2</span> id.scan_local_c<a class="anchor" aria-label="anchor" href="#id.scan_local_c-2"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: Scan identifier (one average spectra per scanner).</li>
<li>ðŸ”¢ Type: string.</li>
<li>ðŸ“– Example: NEO1_030747.</li>
</ul>
</div>
<div id="scan.lab_utf8_txt" class="section level3" number="5.3.3">
<h3>
<span class="header-section-number">5.3.3</span> scan.lab_utf8_txt<a class="anchor" aria-label="anchor" href="#scan.lab_utf8_txt"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: Scanning laboratory.</li>
<li>ðŸ”¢ Type: string.</li>
<li>ðŸ“– Example: Woodwell.</li>
</ul>
</div>
<div id="scan.visnir.date.begin_iso.8601_yyyy.mm.dd-1" class="section level3" number="5.3.4">
<h3>
<span class="header-section-number">5.3.4</span> scan.visnir.date.begin_iso.8601_yyyy.mm.dd<a class="anchor" aria-label="anchor" href="#scan.visnir.date.begin_iso.8601_yyyy.mm.dd-1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: Begin date of scanning following YYYY-MM-DD format (ISO 8601).</li>
<li>ðŸ”¢ Type: string.</li>
<li>ðŸ“– Example: 2021-01-01.</li>
</ul>
</div>
<div id="scan.visnir.date.end_iso.8601_yyyy.mm.dd-1" class="section level3" number="5.3.5">
<h3>
<span class="header-section-number">5.3.5</span> scan.visnir.date.end_iso.8601_yyyy.mm.dd<a class="anchor" aria-label="anchor" href="#scan.visnir.date.end_iso.8601_yyyy.mm.dd-1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: Begin date of scanning following YYYY-MM-DD format (ISO 8601).</li>
<li>ðŸ”¢ Type: string.</li>
<li>ðŸ“– Example: 2022-12-31.</li>
</ul>
</div>
<div id="scan.nir.model.name_utf8_txt" class="section level3" number="5.3.6">
<h3>
<span class="header-section-number">5.3.6</span> scan.nir.model.name_utf8_txt<a class="anchor" aria-label="anchor" href="#scan.nir.model.name_utf8_txt"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: NIR scanner code.</li>
<li>ðŸ”¢ Type: string.</li>
<li>ðŸ“– Example: NEO1.</li>
</ul>
</div>
<div id="scan.nir.model.serialnumber_utf8_in" class="section level3" number="5.3.7">
<h3>
<span class="header-section-number">5.3.7</span> scan.nir.model.serialnumber_utf8_in<a class="anchor" aria-label="anchor" href="#scan.nir.model.serialnumber_utf8_in"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: NIR scanner serial number.</li>
<li>ðŸ”¢ Type: numeric.</li>
<li>ðŸ“– Example: 21020033.</li>
</ul>
</div>
<div id="scan.nir.accessory.used_utf8_txt" class="section level3" number="5.3.8">
<h3>
<span class="header-section-number">5.3.8</span> scan.nir.accessory.used_utf8_txt<a class="anchor" aria-label="anchor" href="#scan.nir.accessory.used_utf8_txt"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: Yes or No for scanning accesory.</li>
<li>ðŸ”¢ Type: string.</li>
<li>ðŸ“– Example: y.</li>
</ul>
</div>
<div id="scan.visnir.method.preparation_any_txt-1" class="section level3" number="5.3.9">
<h3>
<span class="header-section-number">5.3.9</span> scan.visnir.method.preparation_any_txt<a class="anchor" aria-label="anchor" href="#scan.visnir.method.preparation_any_txt-1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: Soil sample preparation before scanning.</li>
<li>ðŸ”¢ Type: string.</li>
<li>ðŸ“– Example: &lt;2 mm.</li>
</ul>
</div>
<div id="scan.visnir.license.title_ascii_txt-1" class="section level3" number="5.3.10">
<h3>
<span class="header-section-number">5.3.10</span> scan.visnir.license.title_ascii_txt<a class="anchor" aria-label="anchor" href="#scan.visnir.license.title_ascii_txt-1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: Dataset scans license.</li>
<li>ðŸ”¢ Type: string.</li>
<li>ðŸ“– Example: CC-BY.</li>
</ul>
</div>
<div id="scan.visnir.license.address_idn_url-1" class="section level3" number="5.3.11">
<h3>
<span class="header-section-number">5.3.11</span> scan.visnir.license.address_idn_url<a class="anchor" aria-label="anchor" href="#scan.visnir.license.address_idn_url-1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: Dataset scans license url.</li>
<li>ðŸ”¢ Type: string.</li>
<li>ðŸ“– Example: <a href="https://creativecommons.org/licenses/by/4.0/" class="uri">https://creativecommons.org/licenses/by/4.0/</a>.</li>
</ul>
</div>
<div id="scan.visnir.doi_idf_url-1" class="section level3" number="5.3.12">
<h3>
<span class="header-section-number">5.3.12</span> scan.visnir.doi_idf_url<a class="anchor" aria-label="anchor" href="#scan.visnir.doi_idf_url-1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: Digital object identifier (DOI) url of the dataset scans.</li>
<li>ðŸ”¢ Type: string.</li>
<li>ðŸ“– Example: <a href="https://doi.org/10.5281/zenodo.7586622" class="uri">https://doi.org/10.5281/zenodo.7586622</a>.</li>
</ul>
</div>
<div id="scan.visnir.contact.name_utf8_txt-1" class="section level3" number="5.3.13">
<h3>
<span class="header-section-number">5.3.13</span> scan.visnir.contact.name_utf8_txt<a class="anchor" aria-label="anchor" href="#scan.visnir.contact.name_utf8_txt-1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: Dataset scans contact name.</li>
<li>ðŸ”¢ Type: string.</li>
<li>ðŸ“– Example: Jonathan Sanderman.</li>
</ul>
</div>
<div id="scan.visnir.contact.email_ietf_txt-1" class="section level3" number="5.3.14">
<h3>
<span class="header-section-number">5.3.14</span> scan.visnir.contact.email_ietf_txt<a class="anchor" aria-label="anchor" href="#scan.visnir.contact.email_ietf_txt-1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: Dataset scans contact email.</li>
<li>ðŸ”¢ Type: string.</li>
<li>ðŸ“– Example: <a href="mailto:jsanderman@woodwellclimate.org" class="email">jsanderman@woodwellclimate.org</a>.</li>
</ul>
</div>
<div id="scan_nir.1350_ref" class="section level3" number="5.3.15">
<h3>
<span class="header-section-number">5.3.15</span> scan_nir.1350_ref<a class="anchor" aria-label="anchor" href="#scan_nir.1350_ref"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: Reflectance in fraction unit, first wavelength in the 1350-2550 nm range.</li>
<li>ðŸ”¢ Type: numeric.</li>
<li>ðŸ“– Example: 0.10403320.</li>
</ul>
</div>
<div id="scan_nir.2550_ref" class="section level3" number="5.3.16">
<h3>
<span class="header-section-number">5.3.16</span> scan_nir.2550_ref<a class="anchor" aria-label="anchor" href="#scan_nir.2550_ref"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>ðŸ“š Description: Reflectance in fraction unit, last wavelength in the 1350-2550 nm range.</li>
<li>ðŸ”¢ Type: numeric.</li>
<li>ðŸ“– Example: 0.3622029.</li>
</ul>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="database-access.html"><span class="header-section-number">4</span> Database access</a></div>
<div class="next"><a href="prediction-models.html"><span class="header-section-number">6</span> Prediction models</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#neospectra-database"><span class="header-section-number">5</span> Neospectra database</a></li>
<li><a class="nav-link" href="#overview"><span class="header-section-number">5.1</span> Overview</a></li>
<li>
<a class="nav-link" href="#database-access-1"><span class="header-section-number">5.2</span> Database access</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#google-cloud-bucket"><span class="header-section-number">5.2.1</span> Google Cloud Bucket</a></li>
<li><a class="nav-link" href="#mongodb-1"><span class="header-section-number">5.2.2</span> MongoDB</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#database-description-1"><span class="header-section-number">5.3</span> Database description</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#id.sample_local_c"><span class="header-section-number">5.3.1</span> id.sample_local_c</a></li>
<li><a class="nav-link" href="#id.scan_local_c-2"><span class="header-section-number">5.3.2</span> id.scan_local_c</a></li>
<li><a class="nav-link" href="#scan.lab_utf8_txt"><span class="header-section-number">5.3.3</span> scan.lab_utf8_txt</a></li>
<li><a class="nav-link" href="#scan.visnir.date.begin_iso.8601_yyyy.mm.dd-1"><span class="header-section-number">5.3.4</span> scan.visnir.date.begin_iso.8601_yyyy.mm.dd</a></li>
<li><a class="nav-link" href="#scan.visnir.date.end_iso.8601_yyyy.mm.dd-1"><span class="header-section-number">5.3.5</span> scan.visnir.date.end_iso.8601_yyyy.mm.dd</a></li>
<li><a class="nav-link" href="#scan.nir.model.name_utf8_txt"><span class="header-section-number">5.3.6</span> scan.nir.model.name_utf8_txt</a></li>
<li><a class="nav-link" href="#scan.nir.model.serialnumber_utf8_in"><span class="header-section-number">5.3.7</span> scan.nir.model.serialnumber_utf8_in</a></li>
<li><a class="nav-link" href="#scan.nir.accessory.used_utf8_txt"><span class="header-section-number">5.3.8</span> scan.nir.accessory.used_utf8_txt</a></li>
<li><a class="nav-link" href="#scan.visnir.method.preparation_any_txt-1"><span class="header-section-number">5.3.9</span> scan.visnir.method.preparation_any_txt</a></li>
<li><a class="nav-link" href="#scan.visnir.license.title_ascii_txt-1"><span class="header-section-number">5.3.10</span> scan.visnir.license.title_ascii_txt</a></li>
<li><a class="nav-link" href="#scan.visnir.license.address_idn_url-1"><span class="header-section-number">5.3.11</span> scan.visnir.license.address_idn_url</a></li>
<li><a class="nav-link" href="#scan.visnir.doi_idf_url-1"><span class="header-section-number">5.3.12</span> scan.visnir.doi_idf_url</a></li>
<li><a class="nav-link" href="#scan.visnir.contact.name_utf8_txt-1"><span class="header-section-number">5.3.13</span> scan.visnir.contact.name_utf8_txt</a></li>
<li><a class="nav-link" href="#scan.visnir.contact.email_ietf_txt-1"><span class="header-section-number">5.3.14</span> scan.visnir.contact.email_ietf_txt</a></li>
<li><a class="nav-link" href="#scan_nir.1350_ref"><span class="header-section-number">5.3.15</span> scan_nir.1350_ref</a></li>
<li><a class="nav-link" href="#scan_nir.2550_ref"><span class="header-section-number">5.3.16</span> scan_nir.2550_ref</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/soilspectroscopy/ossl-manual/blob/master/050-neospectra_database.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/soilspectroscopy/ossl-manual/edit/master/050-neospectra_database.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Open Soil Spectral Library</strong>" was written by Woodwell Climate Research Center, University of Florida, OpenGeoHub and contributors. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
